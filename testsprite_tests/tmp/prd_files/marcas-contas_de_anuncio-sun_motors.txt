# ğŸ“˜ DocumentaÃ§Ã£o do Sistema de GestÃ£o de AnÃºncios Multi-Marcas

Este documento descreve a arquitetura do banco de dados para gestÃ£o de contas de anÃºncios (Meta e Google), focando na resoluÃ§Ã£o de relacionamentos complexos entre Marcas e Contas.

---

## 1. VisÃ£o Geral e Arquitetura

O sistema foi projetado para suportar um cenÃ¡rio hÃ­brido onde algumas contas sÃ£o exclusivas de uma marca, enquanto outras sÃ£o compartilhadas por vÃ¡rias.

### ğŸ—„ï¸ Estrutura do Banco de Dados (Tabelas)

*   **`plataformas`**: Cadastro dos canais de mÃ­dia (ex: Meta Ads, Google Ads).
*   **`marcas`**: As unidades de negÃ³cio (ex: Kia, Suzuki, Haojue, Zontes).
*   **`contas_de_anuncio`**: As contas reais onde o budget Ã© consumido. Possui vÃ­nculo direto (`FK`) com a tabela `plataformas`.
*   **`marcas_contas` (Tabela PivÃ´)**: Tabela associativa que define quais marcas utilizam quais contas.

### ğŸ§  LÃ³gica de NegÃ³cio

O sistema trata automaticamente dois cenÃ¡rios distintos:

1.  **Relacionamento 1:1 (Exclusivo)**
    *   **CenÃ¡rio:** Meta Ads.
    *   **Comportamento:** Cada marca possui sua prÃ³pria conta de anÃºncio.
    *   *Exemplo:* A marca `Suzuki` acessa apenas a conta `Meta - Suzuki`.

2.  **Relacionamento N:1 (Compartilhado)**
    *   **CenÃ¡rio:** Google Ads (Motos).
    *   **Comportamento:** MÃºltiplas marcas utilizam a mesma conta de anÃºncio.
    *   *Exemplo:* As marcas `Suzuki`, `Haojue` e `Zontes` apontam para a mesma conta `Google - Motos Sun Motors`.

---

## ğŸš€ SoluÃ§Ã£o de Acesso: A View `relatorio_completo_marcas`

Para abstrair a complexidade dos `JOINs` e evitar erros na recuperaÃ§Ã£o de dados, foi criada uma **View SQL** que deve ser o ponto Ãºnico de acesso para consultas de leitura.

### DefiniÃ§Ã£o da View
A view consolida as 4 tabelas principais em uma estrutura plana e simples.

| Campo Retornado | DescriÃ§Ã£o |
| :--- | :--- |
| `marca` | Nome da marca (ex: "Suzuki") |
| `plataforma` | Nome da plataforma (ex: "Google Ads") |
| `conta_nome` | Nome da conta de anÃºncio (ex: "Google - Motos Sun Motors") |
| `conta_id` | UUID da conta de anÃºncio |
| `marca_id` | UUID da marca |
| `plataforma_id` | UUID da plataforma |

---

## ğŸ‘¨â€ğŸ’» Guia de ImplementaÃ§Ã£o

### 1. Para Desenvolvedores (Supabase/JS)

**NÃƒO** realize JOINs manuais no cÃ³digo da aplicaÃ§Ã£o. Utilize sempre a view para garantir que as regras de contas compartilhadas sejam respeitadas.

```javascript
// Exemplo: Buscar todas as contas da marca 'Zontes'
// Isso retornarÃ¡ automaticamente a conta do Meta (exclusiva) E a do Google (compartilhada)
const { data, error } = await supabase
  .from('relatorio_completo_marcas') 
  .select('*')
  .eq('marca', 'Zontes');

/*
  RETORNO ESPERADO:
  [
    { 
      marca: "Zontes", 
      plataforma: "Meta Ads", 
      conta_nome: "Meta - Zontes", 
      conta_id: "..." 
    },
    { 
      marca: "Zontes", 
      plataforma: "Google Ads", 
      conta_nome: "Google - Motos Sun Motors", 
      conta_id: "..." 
    }
  ]
*/

COMO PROCEDER:
Utilize exclusivamente a view chamada relatorio_completo_marcas.

Se o usuÃ¡rio perguntar "Quais as contas da Suzuki?", faÃ§a um SELECT * FROM relatorio_completo_marcas WHERE marca = 'Suzuki'.

A view retornarÃ¡ automaticamente a conta exclusiva do Meta E a conta compartilhada do Google. Acredite no retorno dessa view.



====================================================================================================================================


COMO ESTA NO BANCO DE DADOS



PLATAFORMAS

| id                                   | nome       | criado_em                     |
| ------------------------------------ | ---------- | ----------------------------- |
| 73aa8442-ad43-4bc3-96a2-5e21af1503e3 | Meta Ads   | 2025-08-20 20:30:47.289428+00 |
| f6f860bc-25e0-40b9-9960-2acf4118eca5 | Google Ads | 2025-08-20 20:30:47.289428+00 |




MARCAS

| idÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | nomeÂ  Â |
| ------------------------------------ | ------ |
| 814a8753-582b-480c-8e19-3b768ca77fd8 | KiaÂ  Â  |
| e8d625c7-dd9e-454f-89e5-28078859bc7d | Suzuki |
| b1dcfa89-384f-4f01-9eff-64abb6e44797 | Haojue |
| 0f086679-a9a1-4f91-b27b-bbda9d4b3d0c | Zontes |




CONTAS DE ANUNCIO


| idÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | nomeÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  |
| ------------------------------------ | ------------------------- |
| 328b305a-04b8-4f77-9322-5cb68e1ad11d | Meta - ZontesÂ  Â  Â  Â  Â  Â  Â |
| 65a21d11-6846-4981-8795-19b7d12d8258 | Meta - SuzukiÂ  Â  Â  Â  Â  Â  Â |
| d79198ed-0bd0-4a9e-aeee-c1316ae9541a | Meta - KiaÂ  Â  Â  Â  Â  Â  Â  Â  |
| 405c115e-7492-490d-b25b-0c81237b43c3 | Meta - HaojueÂ  Â  Â  Â  Â  Â  Â |
| 55e1458e-f910-4648-af4a-b53566fce0e5 | Google - Kia Sun MotorsÂ  Â |
| 0f8d9d88-9190-49c8-bab0-e3d0f644cdd0 | Google - Motos Sun Motors |




MARCAS CONTAS

| marca_id                             | conta_de_anuncio_id                  |
| ------------------------------------ | ------------------------------------ |
| 0f086679-a9a1-4f91-b27b-bbda9d4b3d0c | 328b305a-04b8-4f77-9322-5cb68e1ad11d |
| e8d625c7-dd9e-454f-89e5-28078859bc7d | 65a21d11-6846-4981-8795-19b7d12d8258 |
| 814a8753-582b-480c-8e19-3b768ca77fd8 | d79198ed-0bd0-4a9e-aeee-c1316ae9541a |
| b1dcfa89-384f-4f01-9eff-64abb6e44797 | 405c115e-7492-490d-b25b-0c81237b43c3 |
| 814a8753-582b-480c-8e19-3b768ca77fd8 | 55e1458e-f910-4648-af4a-b53566fce0e5 |
| 0f086679-a9a1-4f91-b27b-bbda9d4b3d0c | 0f8d9d88-9190-49c8-bab0-e3d0f644cdd0 |
| e8d625c7-dd9e-454f-89e5-28078859bc7d | 0f8d9d88-9190-49c8-bab0-e3d0f644cdd0 |
| b1dcfa89-384f-4f01-9eff-64abb6e44797 | 0f8d9d88-9190-49c8-bab0-e3d0f644cdd0 |


